# ç›‘æ§
PMM = Percona Monitoring and Managementã€‚
PMMæä¾›äº†å¯¹MyISAMã€InnoDBã€TokuDBã€PXC/Glareraçš„ç›‘æ§ã€‚
å¹¶ä¸”æä¾›ç¡¬ç›˜ã€ç½‘ç»œã€CPUã€RAMä»¥åŠContext switcheså’ŒProcessesçš„ç›‘æ§ã€‚
Context switcheså¯ä»¥çœ‹åˆ°CPUä¸Šä¸‹æ–‡åˆ‡æ¢çš„çŠ¶å†µã€‚
Processeså¯ä»¥æ–¹ä¾¿äº†è§£ç³»ç»Ÿæœ‰å¤šå°‘ç¨‹åºåœ¨ç­‰å¾…IO

1. ç›‘æ§æ ¸å¿ƒSQL
2. ç›‘æ§æ ¸å¿ƒæŒ‡æ ‡
3. æŠ¥è­¦

PMM æœ‰ PMM Client å’Œ PMM Serverç»„æˆã€‚PMM Clientè´Ÿè´£æ”¶é›†MySQLæˆ–è€…MongoDBå®ä¾‹çš„çŠ¶æ€æ•°æ®å¹¶å‘é€ç»™PMM Serverã€‚è€ŒServerè´Ÿè´£å°†æ”¶é›†åˆ°çš„æ•°æ®å­˜å‚¨ã€èšåˆå’Œå±•ç°ã€‚

## å®‰è£…
### 1. å®‰è£…docker for Mac
```
âœ  ~ git:(master) âœ— brew install docker
Updating Homebrew...
==> Auto-updated Homebrew!
Updated 3 taps (homebrew/core, homebrew/php, caskroom/cask).
==> Updated Formulae
sysbench âœ”      ccm             elvish          ibex            kotlin          libre           postgis         tile38
azure-cli       certbot         geoip           idnits          libdvdread      libuv           rpm             todoman
binaryen        chakra          git             jenkins-lts     libmaxminddb    linkerd         serialosc       transmission
bzt             chuck           gjs             joplin          libmonome       modules         stress-ng       ttyd
cake            elixir          hugo            juju            libqalculate    paket           svgcleaner

==> Downloading https://homebrew.bintray.com/bottles/docker-18.01.0.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring docker-18.01.0.high_sierra.bottle.tar.gz
==> Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d

zsh completions have been installed to:
  /usr/local/share/zsh/site-functions

fish completions have been installed to:
  /usr/local/share/fish/vendor_completions.d
==> Summary
ğŸº  /usr/local/Cellar/docker/18.01.0: 8 files, 49.6MB


âœ  ~ git:(master) âœ— docker --version
Docker version 18.01.0-ce, build 03596f5



âœ  ~ git:(master) âœ— brew install docker-machine
==> Downloading https://homebrew.bintray.com/bottles/docker-machine-0.13.0.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring docker-machine-0.13.0.high_sierra.bottle.tar.gz
==> Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d

zsh completions have been installed to:
  /usr/local/share/zsh/site-functions

To have launchd start docker-machine now and restart at login:
  brew services start docker-machine
Or, if you don't want/need a background service you can just run:
  docker-machine start
==> Summary
ğŸº  /usr/local/Cellar/docker-machine/0.13.0: 11 files, 31.2MB
âœ  ~ git:(master) âœ— docker-machine --version
docker-machine version 0.13.0, build 9ba6da9



âœ  ~ git:(master) âœ— docker-compose --version
zsh: command not found: docker-compose
âœ  ~ git:(master) âœ— brew install docker-compose
==> Installing dependencies for docker-compose: libyaml
==> Installing docker-compose dependency: libyaml
==> Downloading https://homebrew.bintray.com/bottles/libyaml-0.1.7.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libyaml-0.1.7.high_sierra.bottle.tar.gz
ğŸº  /usr/local/Cellar/libyaml/0.1.7: 9 files, 299.8KB
==> Installing docker-compose
==> Downloading https://homebrew.bintray.com/bottles/docker-compose-1.18.0.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring docker-compose-1.18.0.high_sierra.bottle.tar.gz
==> Caveats
Bash completion has been installed to:
  /usr/local/etc/bash_completion.d

zsh completions have been installed to:
  /usr/local/share/zsh/site-functions
==> Summary
ğŸº  /usr/local/Cellar/docker-compose/1.18.0: 837 files, 9.2MB

âœ  ~ git:(master) âœ— docker-compose --version
docker-compose version 1.18.0, build unknown
âœ  ~ git:(master) âœ—



âœ  ~ git:(master) âœ— brew install xhyve docker-machine-driver-xhyve
==> Downloading https://homebrew.bintray.com/bottles/xhyve-0.2.0.high_sierra.bottle.1.tar.gz
######################################################################## 100.0%
==> Pouring xhyve-0.2.0.high_sierra.bottle.1.tar.gz
ğŸº  /usr/local/Cellar/xhyve/0.2.0: 10 files, 11.2MB
==> Installing dependencies for docker-machine-driver-xhyve: libev
==> Installing docker-machine-driver-xhyve dependency: libev
==> Downloading https://homebrew.bintray.com/bottles/libev-4.24.high_sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libev-4.24.high_sierra.bottle.tar.gz
ğŸº  /usr/local/Cellar/libev/4.24: 12 files, 432.8KB
==> Installing docker-machine-driver-xhyve
==> Downloading https://homebrew.bintray.com/bottles/docker-machine-driver-xhyve-0.3.3.high_sierra.bottle.1.tar.gz
######################################################################## 100.0%
==> Pouring docker-machine-driver-xhyve-0.3.3.high_sierra.bottle.1.tar.gz
==> Caveats
This driver requires superuser privileges to access the hypervisor. To
enable, execute
    sudo chown root:wheel /usr/local/opt/docker-machine-driver-xhyve/bin/docker-machine-driver-xhyve
    sudo chmod u+s /usr/local/opt/docker-machine-driver-xhyve/bin/docker-machine-driver-xhyve
==> Summary
ğŸº  /usr/local/Cellar/docker-machine-driver-xhyve/0.3.3: 3 files, 10.5MB

```
### 1.1 æ¸…é™¤ä¹‹å‰Dockerå®‰è£…çš„ä¿¡æ¯
```
âœ  ~ git:(master) âœ—
âœ  ~ git:(master) âœ— sh -c "$(curl -fsSl https://raw.githubusercontent.com/docker/toolbox/master/osx/uninstall.sh)"
Remove all Docker Machine VMs? (Y/N): y
Usage: docker-machine rm [OPTIONS] [arg...]

Remove a machine

Description:
   Argument(s) are one or more machine names.

Options:

   --force, -f	Remove local configuration even if machine cannot be removed, also implies an automatic yes (`-y`)
   -y		Assumes automatic yes to proceed with remove, without prompting further user confirmation
Error: Expected to get one or more machine names as arguments
Removing Applications...
Removing docker binaries...
Removing boot2docker.iso
Forget packages
No receipt for 'io.docker.pkg.docker' found at '/'.
No receipt for 'io.docker.pkg.dockercompose' found at '/'.
No receipt for 'io.docker.pkg.dockermachine' found at '/'.
No receipt for 'io.boot2dockeriso.pkg.boot2dockeriso' found at '/'.
All Done!
âœ  ~ git:(master) âœ— sudo rm -rf ~/.docker

```

### 2. åˆ›å»ºmachine
```
âœ  ~ git:(master) âœ—
âœ  ~ git:(master) âœ— docker-machine create default --driver xhyve --xhyve-experimental-nfs-share --engine-registry-mirror=https://xxx.mirror.aliyuncs.com
Creating CA: /Users/ShaoGaoJie/.docker/machine/certs/ca.pem
Creating client certificate: /Users/ShaoGaoJie/.docker/machine/certs/cert.pem
Running pre-create checks...
Error with pre-create check: "docker-machine-driver-xhyve binary needs root owner and uid. See https://github.com/zchee/docker-machine-driver-xhyve#install"
âœ  ~ git:(master) âœ—

```

### 3. é•œåƒ

```
âœ  ~ git:(master) âœ— cd Works/mysqldata
âœ  mysqldata git:(master) âœ— docker pull percona/pmm-server:latest
latest: Pulling from percona/pmm-server
85432449fd0f: Pull complete
f366db7bb0d7: Pull complete
702ef97f7925: Pull complete
d9e6e0965c68: Pull complete
83d9c898803b: Pull complete
b86122913f1e: Pull complete
57117cab01ea: Pull complete
197f30644eb4: Pull complete
18fc6d6ea79c: Pull complete
Digest: sha256:3fc6934468e698b86ee799b9b753cd8b4411a169b12118dfb461e4faf9d6d7e3
Status: Downloaded newer image for percona/pmm-server:latest
âœ  mysqldata git:(master) âœ—

```

